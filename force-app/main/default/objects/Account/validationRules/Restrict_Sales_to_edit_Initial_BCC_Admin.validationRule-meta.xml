<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Restrict_Sales_to_edit_Initial_BCC_Admin</fullName>
    <active>true</active>
    <description>Restricts Sales and Renewal users to edit Initial BCC Admin field when there is a value in username field.</description>
    <errorConditionFormula>OR(
AND(
NOT(ISPICKVAL($User.Business_Group__c, &quot;MSP&quot;)),
ISCHANGED(Initial_BCC_Admin__c),
NOT(
OR(
$Profile.Name = &quot;Apollo: API&quot;,
$Profile.Name = &quot;Salesforce API Only System Integrations&quot;,
$Profile.Name = &quot;SalesforceIQ Integration User&quot;,
$Profile.Name = &quot;Sales Insights Integration User&quot;,
$Profile.Name = &quot;System Administrator&quot;,
$Profile.Name = &quot;System Administrator-Testing&quot;,
$Profile.Name = &quot;Technical Architect&quot;
)
)
),
AND(
ISPICKVAL($User.Business_Group__c, &quot;MSP&quot;),
NOT(ISBLANK(User_na__c)),
ISCHANGED(Initial_BCC_Admin__c),
OR(
$Profile.Name = &quot;Apollo: Custom- Sales Engineers Profile&quot;,
$Profile.Name = &quot;Apollo: Custom- Sales Operations&quot;,
$Profile.Name = &quot;Apollo: Custom- Renewals Profile&quot;,
$Profile.Name = &quot;Apollo: Custom- Sales Profile&quot;
)
),
AND(
ISPICKVAL($User.Business_Group__c, &quot;MSP&quot;),
NOT( BusinessGroup__c = &quot;MSP&quot;),
ISCHANGED(Initial_BCC_Admin__c),
NOT(
OR(
$Profile.Name = &quot;Apollo: API&quot;,
$Profile.Name = &quot;Salesforce API Only System Integrations&quot;,
$Profile.Name = &quot;SalesforceIQ Integration User&quot;,
$Profile.Name = &quot;Sales Insights Integration User&quot;,
$Profile.Name = &quot;System Administrator&quot;,
$Profile.Name = &quot;System Administrator-Testing&quot;,
$Profile.Name = &quot;Technical Architect&quot;
)
)
)
)</errorConditionFormula>
    <errorDisplayField>Initial_BCC_Admin__c</errorDisplayField>
    <errorMessage>Only MSP Sales/SE team can edit Initial BCC Admin field, and only when there is no value for username</errorMessage>
</ValidationRule>
