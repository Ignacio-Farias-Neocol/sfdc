<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Closed_Won_Address</fullName>
    <active>true</active>
    <description>Opportunity must have Full Billing and Full Shipping Addresses before it close. Please use Bill/Ship To Address button to select and populate the addresses. NOTE: this rule should match the logic in VR Address_Req_before_Quote_Creation in SBQQ__Quote__c</description>
    <errorConditionFormula>AND( 
    OR(ISPICKVAL(StageName, &apos;Closed Won&apos;),ISPICKVAL(StageName, &apos;Order in Process&apos;)),
NOT( $Permission.BYPASS_ALL_VALIDATIONS_ON_OPPTY ), 
	OR(
		ISBLANK( Street__c ),
		ISBLANK( City__c ),
		ISBLANK( Country__c ),
		AND( CONTAINS( &apos;DZ,AR,AM,AU,AT,AZ,A2,BD,BY,BE,BA,BR,BN,BG,CA,IC,CN,HR,CY,CZ,DK,EN,EE,FO,FI,FR,GE,DE,GR,GL,GU,GG,HO,HU,IN,ID,IL,IT,JP,JE,KZ,KR,KO,KG,LV,LI,LT,LU,MK,MG,M3,MY,MH,MQ,YT,MX,MN,ME,NL,NZ,NB,NO,PK,PH,PL,PO,PT,PR,RE,RU,SA,SF,CS,SG,SK,SI,ZA,ES,LK,NT,SX,UV,VL,SE,CH,TW,TJ,TH,TU,TN,TR,TM,VI,UA,GB,US,UY,UZ,VA,VN,WL,YA&apos;, Country_ISO_Code__c), ISBLANK( Zip_Postal_Code__c )),

		ISBLANK( Ship_To_Street__c ),
		ISBLANK( Ship_To_City__c ),
		ISBLANK( Ship_To_Country__c ),

		AND( CONTAINS( &apos;DZ,AR,AM,AU,AT,AZ,A2,BD,BY,BE,BA,BR,BN,BG,CA,IC,CN,HR,CY,CZ,DK,EN,EE,FO,FI,FR,GE,DE,GR,GL,GU,GG,HO,HU,IN,ID,IL,IT,JP,JE,KZ,KR,KO,KG,LV,LI,LT,LU,MK,MG,M3,MY,MH,MQ,YT,MX,MN,ME,NL,NZ,NB,NO,PK,PH,PL,PO,PT,PR,RE,RU,SA,SF,CS,SG,SK,SI,ZA,ES,LK,NT,SX,UV,VL,SE,CH,TW,TJ,TH,TU,TN,TR,TM,VI,UA,GB,US,UY,UZ,VA,VN,WL,YA&apos;, Shipping_Country_ISO_Code__c), ISBLANK( Ship_To_Zip_Postal_Code__c )),

		AND( CONTAINS(&apos;US,CA&apos;, Country_ISO_Code__c), ISBLANK( State__c )),
		AND( CONTAINS(&apos;US,CA&apos;, Shipping_Country_ISO_Code__c), ISBLANK( Ship_To_State__c ))
	)
)</errorConditionFormula>
    <errorMessage>Opportunity must have COMPLETE Billing and Shipping Addresses before you can close it. Please click the &apos;Bill/Ship To Address&apos; button to select the addresses.</errorMessage>
</ValidationRule>
