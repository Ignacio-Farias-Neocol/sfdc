<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Activate_Address</fullName>
    <active>true</active>
    <description>Order must have Full Billing and Full Shipping Addresses before it is activated. Please populate the addresses.</description>
    <errorConditionFormula>AND( 
    ISPICKVAL( Status , &apos;Activated&apos;), 
    OR(
		ISBLANK( Bill_To_Contact__c ),
		ISBLANK( Bill_To_Contact_Email__c ),
		ISBLANK( Ship_To_Contact__c ),
		ISBLANK( Ship_To_Contact_Email__c ),

                ISBLANK(Billing_Address__c),
		ISBLANK( BillingStreet ),
		ISBLANK( BillingCity ),
		ISBLANK( BillingCountry ),
		AND(NOT(ISBLANK(TEXT( BillingCountryCode ))),
		     CONTAINS( &apos;DZ,AR,AM,AU,AT,AZ,A2,BD,BY,BE,BA,BR,BN,BG,CA,IC,CN,HR,CY,CZ,DK,EN,EE,FO,FI,FR,GE,DE,GR,GL,GU,GG,HO,HU,IN,ID,IL,IT,JP,JE,KZ,KR,KO,KG,LV,LI,LT,LU,MK,MG,M3,MY,MH,MQ,YT,MX,MN,ME,NL,NZ,NB,NO,PK,PH,PL,PO,PT,PR,RE,RU,SA,SF,CS,SG,SK,SI,ZA,ES,LK,NT,SX,UV,VL,SE,CH,TW,TJ,TH,TU,TN,TR,TM,VI,UA,GB,US,UY,UZ,VA,VN,WL,YA&apos;, TEXT( BillingCountryCode )), 
		     ISBLANK( BillingPostalCode )),

                ISBLANK(Shipping_Address__c),
		ISBLANK( ShippingStreet ),
		ISBLANK( ShippingCity ),
		ISBLANK( ShippingCountry ),
		AND(NOT(ISBLANK(TEXT( ShippingCountryCode ))),
		     CONTAINS( &apos;DZ,AR,AM,AU,AT,AZ,A2,BD,BY,BE,BA,BR,BN,BG,CA,IC,CN,HR,CY,CZ,DK,EN,EE,FO,FI,FR,GE,DE,GR,GL,GU,GG,HO,HU,IN,ID,IL,IT,JP,JE,KZ,KR,KO,KG,LV,LI,LT,LU,MK,MG,M3,MY,MH,MQ,YT,MX,MN,ME,NL,NZ,NB,NO,PK,PH,PL,PO,PT,PR,RE,RU,SA,SF,CS,SG,SK,SI,ZA,ES,LK,NT,SX,UV,VL,SE,CH,TW,TJ,TH,TU,TN,TR,TM,VI,UA,GB,US,UY,UZ,VA,VN,WL,YA&apos;, TEXT( ShippingCountryCode )), 
		     ISBLANK( ShippingPostalCode )),

		AND( NOT(ISBLANK(TEXT(BillingCountryCode))),CONTAINS(&apos;US,CA&apos;, TEXT(BillingCountryCode)), ISBLANK( BillingState )),
		AND( NOT(ISBLANK(TEXT(ShippingCountryCode))),CONTAINS(&apos;US,CA&apos;, TEXT(ShippingCountryCode)), ISBLANK( ShippingState ))
    )
)</errorConditionFormula>
    <errorDisplayField>AccountId</errorDisplayField>
    <errorMessage>The Order must have COMPLETE Billing and Shipping Addresses before it is activated. Please populate the addresses.</errorMessage>
</ValidationRule>
